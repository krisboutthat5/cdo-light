### Eclipse Workspace Patch 1.0
#P org.eclipse.net4j.util
Index: META-INF/MANIFEST.MF
===================================================================
--- META-INF/MANIFEST.MF	(revision 7)
+++ META-INF/MANIFEST.MF	(working copy)
@@ -3,8 +3,8 @@
 Bundle-RequiredExecutionEnvironment: J2SE-1.5
 Bundle-SymbolicName: org.eclipse.net4j.util;singleton:=true
 Bundle-Activator: org.eclipse.net4j.internal.util.bundle.OM$Activator
-Require-Bundle: org.eclipse.core.runtime;bundle-version="[3.4.0,4.0.0)
- ";resolution:=optional
+Require-Bundle: org.eclipse.core.runtime;bundle-version="[3.4.0,4.0.0)";resolution:=optional,
+ org.eclipselabs.cdolight;bundle-version="0.1.0"
 Export-Package: org.eclipse.net4j.internal.util.bundle;version="3.1.0"
  ;x-friends:="org.eclipse.net4j.util.ui,org.eclipse.net4j.tests",org.e
  clipse.net4j.internal.util.container;version="3.1.0";x-friends:="org.
Index: src/org/eclipse/net4j/util/fsm/ITransition.java
===================================================================
--- src/org/eclipse/net4j/util/fsm/ITransition.java	(revision 7)
+++ src/org/eclipse/net4j/util/fsm/ITransition.java	(working copy)
@@ -10,10 +10,14 @@
  */
 package org.eclipse.net4j.util.fsm;
 
+import org.eclipselabs.cdolight.utils.CDOTracingUtils;
+
 /**
  * @author Eike Stepper
  */
-public interface ITransition<STATE extends Enum<?>, EVENT extends Enum<?>, SUBJECT, DATA>
+public class ITransition<STATE extends Enum<?>, EVENT extends Enum<?>, SUBJECT, DATA>
 {
-  public void execute(SUBJECT subject, STATE state, EVENT event, DATA data);
+  public void execute(SUBJECT subject, STATE state, EVENT event, DATA data){
+	  CDOTracingUtils.appendHtmlTrace("ITransition.execute() - " +this);
+  }
 }
Index: src/org/eclipse/net4j/util/fsm/FiniteStateMachine.java
===================================================================
--- src/org/eclipse/net4j/util/fsm/FiniteStateMachine.java	(revision 7)
+++ src/org/eclipse/net4j/util/fsm/FiniteStateMachine.java	(working copy)
@@ -226,10 +226,11 @@
   /**
    * @author Eike Stepper
    */
-  public static class IgnoreTransition implements ITransition<Enum<?>, Enum<?>, Object, Object>
+  public static class IgnoreTransition extends ITransition<Enum<?>, Enum<?>, Object, Object>
   {
     public void execute(Object subject, Enum<?> state, Enum<?> event, Object data)
     {
+    	super.execute(subject, state, event, data);
       // Do nothing
     }
 
@@ -243,10 +244,11 @@
   /**
    * @author Eike Stepper
    */
-  public static class FailTransition implements ITransition<Enum<?>, Enum<?>, Object, Object>
+  public static class FailTransition extends ITransition<Enum<?>, Enum<?>, Object, Object>
   {
     public void execute(Object subject, Enum<?> state, Enum<?> event, Object data)
     {
+    	super.execute(subject, state, event, data);
       // Do nothing
     }
 
@@ -260,7 +262,7 @@
   /**
    * @author Eike Stepper
    */
-  public class ChangeStateTransition implements ITransition<STATE, EVENT, SUBJECT, Object>
+  public class ChangeStateTransition extends ITransition<STATE, EVENT, SUBJECT, Object>
   {
     private STATE targetState;
 
@@ -276,6 +278,7 @@
 
     public void execute(SUBJECT subject, STATE state, EVENT event, Object data)
     {
+    	super.execute(subject, state, event, data);
       changeState(subject, targetState);
     }
 
Index: src/org/eclipse/net4j/util/security/ChallengeResponseNegotiator.java
===================================================================
--- src/org/eclipse/net4j/util/security/ChallengeResponseNegotiator.java	(revision 7)
+++ src/org/eclipse/net4j/util/security/ChallengeResponseNegotiator.java	(working copy)
@@ -188,10 +188,11 @@
   /**
    * @author Eike Stepper
    */
-  protected abstract class Transition implements ITransition<State, Event, INegotiationContext, ByteBuffer>
+  protected abstract class Transition extends ITransition<State, Event, INegotiationContext, ByteBuffer>
   {
     public final void execute(INegotiationContext context, State state, Event event, ByteBuffer buffer)
     {
+    	super.execute(context, state, event, buffer);
       execute(context, buffer);
     }
 
Index: src/org/eclipse/net4j/util/lifecycle/Lifecycle.java
===================================================================
--- src/org/eclipse/net4j/util/lifecycle/Lifecycle.java	(revision 7)
+++ src/org/eclipse/net4j/util/lifecycle/Lifecycle.java	(working copy)
@@ -10,6 +10,8 @@
  */
 package org.eclipse.net4j.util.lifecycle;
 
+import java.util.concurrent.Semaphore;
+
 import org.eclipse.net4j.internal.util.bundle.OM;
 import org.eclipse.net4j.util.CheckUtil;
 import org.eclipse.net4j.util.ReflectUtil;
@@ -17,8 +19,7 @@
 import org.eclipse.net4j.util.event.IListener;
 import org.eclipse.net4j.util.event.Notifier;
 import org.eclipse.net4j.util.om.trace.ContextTracer;
-
-import java.util.concurrent.Semaphore;
+import org.eclipselabs.cdolight.utils.CDOTracingUtils;
 
 /**
  * @author Eike Stepper
@@ -51,6 +52,7 @@
   {
     try
     {
+    	CDOTracingUtils.appendHtmlTrace("Lifecycle.activate() - " +this);
       if (lifecycleState == LifecycleState.INACTIVE)
       {
         if (TRACER.isEnabled())
@@ -103,6 +105,7 @@
 
   public final Exception deactivate()
   {
+	  CDOTracingUtils.appendHtmlTrace("Lifecycle.deactivate() - " +this);
     try
     {
       if (lifecycleState == LifecycleState.ACTIVE)
#P org.eclipse.emf.cdo.server
Index: src/org/eclipse/emf/cdo/internal/server/mem/MEMStore.java
===================================================================
--- src/org/eclipse/emf/cdo/internal/server/mem/MEMStore.java	(revision 7)
+++ src/org/eclipse/emf/cdo/internal/server/mem/MEMStore.java	(working copy)
@@ -100,7 +100,17 @@
 
   private int lastLocalBranchID;
 
-  private Map<Object, List<InternalCDORevision>> revisions = new HashMap<Object, List<InternalCDORevision>>();
+  private Map<Object, List<InternalCDORevision>> revisions = new HashMap<Object, List<InternalCDORevision>>(){
+	  
+	public java.util.List<InternalCDORevision> put(Object key, java.util.List<InternalCDORevision> value) {
+		return super.put(key, value);
+	};
+	
+	public java.util.List<InternalCDORevision> get(Object key) {
+		return super.get(key);
+	};
+	
+  };
 
   private List<CommitInfo> commitInfos = new ArrayList<CommitInfo>();
 
#P org.eclipse.net4j
Index: src/org/eclipse/net4j/signal/IndicationWithResponse.java
===================================================================
--- src/org/eclipse/net4j/signal/IndicationWithResponse.java	(revision 7)
+++ src/org/eclipse/net4j/signal/IndicationWithResponse.java	(working copy)
@@ -15,6 +15,7 @@
 import org.eclipse.net4j.util.StringUtil;
 import org.eclipse.net4j.util.io.ExtendedDataInputStream;
 import org.eclipse.net4j.util.io.ExtendedDataOutputStream;
+import org.eclipselabs.cdolight.utils.CDOTracingUtils;
 
 /**
  * @author Eike Stepper
@@ -56,6 +57,7 @@
   @Override
   protected void execute(BufferInputStream in, BufferOutputStream out) throws Exception
   {
+	  CDOTracingUtils.appendHtmlTrace("IndicationWithResponse.execute() - " +toString());
     boolean responding = false;
 
     try
Index: src/org/eclipse/net4j/signal/Indication.java
===================================================================
--- src/org/eclipse/net4j/signal/Indication.java	(revision 7)
+++ src/org/eclipse/net4j/signal/Indication.java	(working copy)
@@ -13,6 +13,7 @@
 import org.eclipse.net4j.buffer.BufferInputStream;
 import org.eclipse.net4j.buffer.BufferOutputStream;
 import org.eclipse.net4j.util.io.ExtendedDataInputStream;
+import org.eclipselabs.cdolight.utils.CDOTracingUtils;
 
 /**
  * @author Eike Stepper
@@ -46,6 +47,7 @@
   @Override
   protected void execute(BufferInputStream in, BufferOutputStream out) throws Exception
   {
+	  CDOTracingUtils.appendHtmlTrace("Indication.execute() - " +toString());
     doInput(in);
   }
 
Index: src/org/eclipse/net4j/signal/SignalActor.java
===================================================================
--- src/org/eclipse/net4j/signal/SignalActor.java	(revision 7)
+++ src/org/eclipse/net4j/signal/SignalActor.java	(working copy)
@@ -12,6 +12,7 @@
 
 import org.eclipse.net4j.buffer.BufferInputStream;
 import org.eclipse.net4j.buffer.BufferOutputStream;
+import org.eclipselabs.cdolight.utils.CDOTracingUtils;
 
 /**
  * @author Eike Stepper
@@ -48,6 +49,7 @@
   @Override
   protected final void execute(BufferInputStream in, BufferOutputStream out) throws Exception
   {
+	  CDOTracingUtils.appendHtmlTrace("SignalActor.execute() - " +toString());
     doExecute(in, out);
   }
 
Index: META-INF/MANIFEST.MF
===================================================================
--- META-INF/MANIFEST.MF	(revision 7)
+++ META-INF/MANIFEST.MF	(working copy)
@@ -3,9 +3,9 @@
 Bundle-RequiredExecutionEnvironment: J2SE-1.5
 Bundle-SymbolicName: org.eclipse.net4j;singleton:=true
 Bundle-Activator: org.eclipse.internal.net4j.bundle.OM$Activator
-Require-Bundle: org.eclipse.core.runtime;bundle-version="[3.4.0,4.0.0)
- ";resolution:=optional,org.eclipse.net4j.util;bundle-version="[3.0.0,
- 4.0.0)";visibility:=reexport
+Require-Bundle: org.eclipse.core.runtime;bundle-version="[3.4.0,4.0.0)";resolution:=optional,
+ org.eclipse.net4j.util;bundle-version="[3.0.0,4.0.0)";visibility:=reexport,
+ org.eclipselabs.cdolight;bundle-version="0.1.0"
 Export-Package: org.eclipse.internal.net4j;version="4.0.0"; x-friends:
  ="org.eclipse.net4j.http.server,  org.eclipse.net4j.jvm,  org.eclipse
  .net4j.tcp,  org.eclipse.net4j.http,  org.eclipse.net4j.http.common, 
#P org.eclipse.emf.cdo
Index: src/org/eclipse/emf/internal/cdo/view/CDOStateMachine.java
===================================================================
--- src/org/eclipse/emf/internal/cdo/view/CDOStateMachine.java	(revision 7)
+++ src/org/eclipse/emf/internal/cdo/view/CDOStateMachine.java	(working copy)
@@ -510,12 +510,13 @@
    * @see AttachTransition
    * @author Eike Stepper
    */
-  private final class PrepareTransition implements
+  private final class PrepareTransition extends
       ITransition<CDOState, CDOEvent, InternalCDOObject, Pair<InternalCDOTransaction, List<InternalCDOObject>>>
   {
     public void execute(InternalCDOObject object, CDOState state, CDOEvent event,
         Pair<InternalCDOTransaction, List<InternalCDOObject>> transactionAndContents)
     {
+    	super.execute(object, state, event, transactionAndContents);
       InternalCDOTransaction transaction = transactionAndContents.getElement1();
       List<InternalCDOObject> contents = transactionAndContents.getElement2();
 
@@ -637,10 +638,11 @@
    * @see PrepareTransition
    * @author Eike Stepper
    */
-  private final class AttachTransition implements ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
+  private final class AttachTransition extends ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
   {
     public void execute(InternalCDOObject object, CDOState state, CDOEvent event, Object NULL)
     {
+    	super.execute(object, state, event, NULL);
       object.cdoInternalPostAttach();
       changeState(object, CDOState.NEW);
     }
@@ -651,11 +653,12 @@
    * 
    * @author Caspar De Groot
    */
-  private final class ReattachTransition implements
+  private final class ReattachTransition extends
       ITransition<CDOState, CDOEvent, InternalCDOObject, InternalCDOTransaction>
   {
     public void execute(InternalCDOObject object, CDOState state, CDOEvent event, InternalCDOTransaction transaction)
     {
+    	super.execute(object, state, event, transaction);
       InternalCDORevisionManager revisionManager = transaction.getSession().getRevisionManager();
       CDORevision cleanRevision = transaction.getCleanRevisions().get(object);
 
@@ -695,12 +698,13 @@
   /**
    * @author Eike Stepper
    */
-  private static final class DetachTransition implements
+  private static final class DetachTransition extends
       ITransition<CDOState, CDOEvent, InternalCDOObject, List<InternalCDOObject>>
   {
     public void execute(InternalCDOObject object, CDOState state, CDOEvent event,
         List<InternalCDOObject> objectsToDetach)
     {
+    	super.execute(object, state, event, objectsToDetach);
       InternalCDOTransaction transaction = (InternalCDOTransaction)object.cdoView();
       objectsToDetach.add(object);
       boolean isResource = object instanceof Resource;
@@ -725,7 +729,7 @@
   /**
    * @author Eike Stepper
    */
-  final private class CommitTransition implements
+  final private class CommitTransition extends
       ITransition<CDOState, CDOEvent, InternalCDOObject, CommitTransactionResult>
   {
     public CommitTransition(boolean useDeltas)
@@ -734,6 +738,7 @@
 
     public void execute(InternalCDOObject object, CDOState state, CDOEvent event, CommitTransactionResult data)
     {
+    	super.execute(object, state, event, data);
       InternalCDOTransaction transaction = object.cdoView().toTransaction();
       InternalCDORevision revision = object.cdoRevision();
       Map<CDOID, CDOID> idMappings = data.getIDMappings();
@@ -763,10 +768,11 @@
   /**
    * @author Eike Stepper
    */
-  private final class RollbackTransition implements ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
+  private final class RollbackTransition extends ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
   {
     public void execute(InternalCDOObject object, CDOState state, CDOEvent event, Object NULL)
     {
+    	super.execute(object, state, event, NULL);
       object.cdoInternalSetRevision(null);
       changeState(object, CDOState.PROXY);
     }
@@ -775,10 +781,11 @@
   /**
    * @author Eike Stepper
    */
-  private final class WriteTransition implements ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
+  private final class WriteTransition extends ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
   {
     public void execute(InternalCDOObject object, CDOState state, CDOEvent event, Object featureDelta)
     {
+    	super.execute(object, state, event, featureDelta);
       InternalCDOTransaction transaction = object.cdoView().toTransaction();
       InternalCDORevision cleanRevision = object.cdoRevision();
       transaction.getCleanRevisions().put(object, cleanRevision);
@@ -795,10 +802,11 @@
   /**
    * @author Simon McDuff
    */
-  private static final class WriteNewTransition implements ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
+  private static final class WriteNewTransition extends ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
   {
     public void execute(InternalCDOObject object, CDOState state, CDOEvent event, Object featureDelta)
     {
+    	super.execute(object, state, event, featureDelta);
       InternalCDOTransaction transaction = object.cdoView().toTransaction();
       transaction.registerFeatureDelta(object, (CDOFeatureDelta)featureDelta);
     }
@@ -807,10 +815,11 @@
   /**
    * @author Simon McDuff
    */
-  private static final class RewriteTransition implements ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
+  private static final class RewriteTransition extends ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
   {
     public void execute(InternalCDOObject object, CDOState state, CDOEvent event, Object featureDelta)
     {
+    	super.execute(object, state, event, featureDelta);
       InternalCDOTransaction transaction = object.cdoView().toTransaction();
       transaction.registerFeatureDelta(object, (CDOFeatureDelta)featureDelta);
     }
@@ -819,12 +828,13 @@
   /**
    * @author Simon McDuff
    */
-  private static class DetachRemoteTransition implements ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
+  private static class DetachRemoteTransition extends ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
   {
     static final DetachRemoteTransition INSTANCE = new DetachRemoteTransition();
 
     public void execute(InternalCDOObject object, CDOState state, CDOEvent event, Object NULL)
     {
+    	super.execute(object, state, event, NULL);
       CDOStateMachine.INSTANCE.changeState(object, CDOState.INVALID);
 
       InternalCDOView view = object.cdoView();
@@ -836,11 +846,12 @@
   /**
    * @author Eike Stepper
    */
-  private class InvalidateTransition implements
+  private class InvalidateTransition extends
       ITransition<CDOState, CDOEvent, InternalCDOObject, Pair<CDORevisionKey, Long>>
   {
     public void execute(InternalCDOObject object, CDOState state, CDOEvent event, Pair<CDORevisionKey, Long> keyAndTime)
     {
+    	super.execute(object, state, event, keyAndTime);
       CDORevisionKey key = keyAndTime.getElement1();
       InternalCDORevision oldRevision = object.cdoRevision();
       if (key == null || key.getVersion() >= oldRevision.getVersion())
@@ -907,7 +918,7 @@
   /**
    * @author Eike Stepper
    */
-  private final class LoadTransition implements ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
+  private final class LoadTransition extends ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
   {
     private boolean forWrite;
 
@@ -918,6 +929,7 @@
 
     public void execute(InternalCDOObject object, CDOState state, CDOEvent event, Object delta)
     {
+    	super.execute(object, state, event, delta);
       object.cdoInternalPreLoad();
 
       InternalCDOView view = object.cdoView();
@@ -943,12 +955,13 @@
   /**
    * @author Simon McDuff
    */
-  private static final class InvalidTransition implements ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
+  private static final class InvalidTransition extends ITransition<CDOState, CDOEvent, InternalCDOObject, Object>
   {
     public static final InvalidTransition INSTANCE = new InvalidTransition();
 
     public void execute(InternalCDOObject object, CDOState state, CDOEvent event, Object NULL)
     {
+    	super.execute(object, state, event, NULL);
       InternalCDOView view = object.cdoView();
       CDOInvalidationPolicy policy = view.options().getInvalidationPolicy();
       policy.handleInvalidObject(object);
